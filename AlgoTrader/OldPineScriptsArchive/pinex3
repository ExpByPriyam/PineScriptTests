//@version=5
indicator("Below Middle Bollinger Band", overlay=true)

// Correcting the parameters for Bollinger Bands
length = input.int(30, title="Length", minval=1)
stdDev = input.float(3.0, title="StdDev", minval=0.01, step=0.01)

// Calculate Bollinger Bands
[sma, upper, lower] = ta.bb(close, length, stdDev)

// Condition to check if the bar's close is below the middle band (SMA)
belowMiddleBand = close < sma

// Plotting the Bollinger Bands for visualization
plot(sma, color=color.blue, title="Middle Band")
plot(upper, color=color.red, title="Upper Band")
plot(lower, color=color.green, title="Lower Band")

// Highlight bars that are below the middle band
bgcolor(belowMiddleBand ? color.new(color.red, 90) : na)
